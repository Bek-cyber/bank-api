# üè¶ Bank API ‚Äî Transactional Backend (Spring Boot)

## üìå –û–ø–∏—Å–∞–Ω–∏–µ

**Bank API** ‚Äî —É—á–µ–±–Ω–æ-–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π backend-—Å–µ—Ä–≤–∏—Å, –∏–º–∏—Ç–∏—Ä—É—é—â–∏–π –±–∞–Ω–∫–æ–≤—Å–∫—É—é —Å–∏—Å—Ç–µ–º—É —Å—á–µ—Ç–æ–≤ –∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π.

–ü—Ä–æ–µ–∫—Ç —Å—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞–Ω –Ω–∞:
- –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç–µ —Å –¥–µ–Ω—å–≥–∞–º–∏,
- –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö,
- –æ–±—Ä–∞–±–æ—Ç–∫–µ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤,
- idempotency –∏ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏.

---

## üéØ –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞
–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è:
- –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π backend-—Å–∏—Å—Ç–µ–º,
- –ø—Ä–∞–∫—Ç–∏–∫–∏ —Ä–∞–±–æ—Ç—ã —Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏, concurrency –∏ consistency.

---

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- Java 21
- Spring Boot 3.2.5
- Spring Data JPA (Hibernate)
- PostgreSQL
- Flyway
- Lombok
- Gradle

---

## üìÇ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```text
com.project.bankapi
‚îú‚îÄ‚îÄ controller        # REST-–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã
‚îú‚îÄ‚îÄ domain
‚îÇ   ‚îú‚îÄ‚îÄ entity        # JPA-—Å—É—â–Ω–æ—Å—Ç–∏
‚îÇ   ‚îú‚îÄ‚îÄ repository    # –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ enums
‚îú‚îÄ‚îÄ dto
‚îÇ   ‚îú‚îÄ‚îÄ request       # DTO –∑–∞–ø—Ä–æ—Å–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ response      # DTO –æ—Ç–≤–µ—Ç–æ–≤
‚îú‚îÄ‚îÄ service           # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îú‚îÄ‚îÄ exception         # –ú–æ–¥–µ–ª—å –æ—à–∏–±–æ–∫ –∏ –≥–ª–æ–±–∞–ª—å–Ω—ã–π handler
‚îî‚îÄ‚îÄ BankApiApplication
```
---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

- –¢–æ–Ω–∫–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã
- –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ —Å–µ—Ä–≤–∏—Å—ã
- Entity –Ω–µ –æ—Ç–¥–∞—é—Ç—Å—è –Ω–∞—Ä—É–∂—É
- –ï–¥–∏–Ω–∞—è –º–æ–¥–µ–ª—å –æ—à–∏–±–æ–∫
- –ß—ë—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

---

## ‚öôÔ∏è –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

- –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö —Å—á–µ—Ç–æ–≤
- –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å—á—ë—Ç–µ
- –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
- –°–ø–∏—Å–∞–Ω–∏–µ —Å—Ä–µ–¥—Å—Ç–≤
- –ê—Ç–æ–º–∞—Ä–Ω—ã–µ –ø–µ—Ä–µ–≤–æ–¥—ã –º–µ–∂–¥—É —Å—á–µ—Ç–∞–º–∏
- –ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
- Health-endpoint –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

---

## üîê –ó–∞—â–∏—Ç–∞ –æ—Ç race conditions

–ü—Ä–æ–µ–∫—Ç –∑–∞—â–∏—â—ë–Ω –æ—Ç **race conditions** (—Å–æ—Å—Ç–æ—è–Ω–∏–π –≥–æ–Ω–∫–∏), –≤–æ–∑–Ω–∏–∫–∞—é—â–∏—Ö –ø—Ä–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö –∫ –æ–¥–Ω–æ–º—É —Å—á—ë—Ç—É.

### –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã:
- **Optimistic locking** (@Version) –Ω–∞ —É—Ä–æ–≤–Ω–µ JPA
- –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ—Å—Ç—å (@Transactional)
- –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã–π retry –ø—Ä–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### –†–µ–∑—É–ª—å—Ç–∞—Ç:

- –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å ¬´—Å–æ–∑–¥–∞–Ω–∏—è –¥–µ–Ω–µ–≥ –∏–∑ –≤–æ–∑–¥—É—Ö–∞¬ª
- –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã—Ö —Å–ø–∏—Å–∞–Ω–∏–π –∏ –ø–µ—Ä–µ–≤–æ–¥–æ–≤
- –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö REST-—Å—Ü–µ–Ω–∞—Ä–∏—è—Ö

---

## üîÅ Exactly-once —Å–µ–º–∞–Ω—Ç–∏–∫–∞ (Idempotency)

–í—Å–µ write-–æ–ø–µ—Ä–∞—Ü–∏–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç **exactly-once —Å–µ–º–∞–Ω—Ç–∏–∫—É**.

### –ö–∞–∫ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:

- –ö–ª–∏–µ–Ω—Ç –ø–µ—Ä–µ–¥–∞—ë—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ **Idempotency-Key**
- –ö–ª—é—á + endpoint —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î
- –ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ –∏—Å–∫–ª—é—á–µ–Ω–æ

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:

- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω **TTL (24 —á–∞—Å–∞)** –¥–ª—è idempotency-–∫–ª—é—á–µ–π
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –∫–ª—é—á–µ–π —á–µ—Ä–µ–∑ scheduled-–∑–∞–¥–∞—á—É
- –¢–∞–±–ª–∏—Ü–∞ –Ω–µ —Ä–∞–∑—Ä–∞—Å—Ç–∞–µ—Ç—Å—è —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º

---

## üóÑ –†–∞–±–æ—Ç–∞ —Å –ë–î –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- –°—Ö–µ–º–∞ –ë–î —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ **Flyway**
- Hibernate —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∂–∏–º–µ **ddl-auto=validate**
- –î–æ–±–∞–≤–ª–µ–Ω—ã –∏–Ω–¥–µ–∫—Å—ã –ø–æ–¥ —Ä–µ–∞–ª—å–Ω—ã–µ –±–∏–∑–Ω–µ—Å-–∑–∞–ø—Ä–æ—Å—ã:
  - –∏—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –ø–æ —Å—á—ë—Ç—É
  - idempotency-–∫–ª—é—á–∏
- –ù–µ—Ç –∏–∑–±—ã—Ç–æ—á–Ω—ã—Ö –∏–Ω–¥–µ–∫—Å–æ–≤ –∏ –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

---

## ‚ö†Ô∏è Concurrency-—Å—Ç—Ä–∞—Ç–µ–≥–∏—è

- –î–ª—è REST-–æ–ø–µ—Ä–∞—Ü–∏–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **optimistic locking**
- –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –∏ –¥–µ–¥–ª–æ–∫–æ–≤
- –ü—Ä–∏ –≤—ã—Å–æ–∫–æ–π –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏ –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å
—Ç–æ—á–µ—á–Ω–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ **pessimistic locking (SELECT FOR UPDATE)**

–¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥:
- —Ö–æ—Ä–æ—à–æ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è
- —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç industry best practices
